curl -X POST -H "Content-Type: application/json" -H "Authorization: Bearer $(cat ./secrets/token)" -d "$(. ./master.sh)" "https://api.digitalocean.com/v2/droplets" > api_outputs/init_master.log
droplet_id=$(cat api_outputs/init_master.log | jq ".droplet.id")
echo $droplet_id
echo -e " I am spinning up a master node. This may take some time. Sleeping for 30 seconds then moving on.\n"
sleep 4m;
echo -e "Nap time over. Moving on...."
curl -X GET -H "Content-Type: application/json" -H "Authorization: Bearer $(cat ./secrets/token)" "https://api.digitalocean.com/v2/droplets/$droplet_id" >> api_outputs/init_master.log 
droplet_ip4=$(cat api_outputs/init_master.log | jq ".droplet.networks.v4"  | cut -d { -f1 | grep ip_address | cut -d : -f2- | cut -d \" -f2) # don't know why JQ complains 
echo $droplet_ip4
scp -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null ./k8-master.sh root@$droplet_ip4:~ 
ssh root@$droplet_ip4 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null ". ./k8-master.sh"


